# Computer Network

## 0 基础概念

**局域网**：

- 覆盖范围小

- 自己花钱购买设备

- 带宽固定

- 自己维护

- 100m以内

- 带宽：10M 100M 1000M

**广域网**：

- 距离远

- 花钱租宽带

**Internet ISP**：

- 自己的机房

- 对网民提供访问 Internet 连接

基本概念：

- 路由

- 网关

- 交换机

- DNS

- 每一个设备都有一个`ip`地址

  - 交换机没有物理地址：mac

  - 交换机多了一个子网掩码

  - 交换机用于数据在它连接的机器之间传输

- 网页是分割发送的

## 1 OSI参考模型

### 1.1 七层网络模型

OSI（Open System Interconnection）开放系统的互联；由ISO（International Standardization Organization）组织确定

- 应用层： 所有能产生网络流量的程序

- 表示层：在传输之前是否进行加密或压缩处理（传输之前进行的处理） 二进制 ASCII码

- 会话层：

   - `netstat -n`查看会话

   - `netstat -nb`查木马，能查看建立的木马通信的程序

- 传输层：

   - 可靠传输（没确认就一直发）；流量控制（处理不过来时候让发送的慢一点）

   - 不可靠传输（不需要建立会话，只需要一个数据包的来回就可以解决问题）所谓不可靠，丢了就再发

   - 纠错

- 网络层：

   - 负责选择最佳通信：（最佳路径），也可以使用静态路由

   - 规划ip地址

- 数据链路层：

   - 定义了帧的开始和结束，实现透明传输，差错校验

- 物理层：

   - 定义数据的接口标准

   - 定义电器标准

   - 如何在物理链路上以更快的速度传输

IPv6 和 IPv4 都在网络层，每一层变化不会影响其他层

从下往上层层递进，下层为上层提供服务

解决问题按层解决，不然会给后期维护带来很大困扰

- 计算机可以添加多个地址（静态ip）：可以用这些地址分别进行通信

- 写网站的时候，可以控制网站是直接访问还是找代理访问，如果找代理的话就会很慢`netstat -n`查看会话

- 2000年以前的光纤，不支持千兆测速传输

### 1.2 OSI对错误排查的指导

- 物理层故障排除：

   - 查看连接状态

   - 发送和接受的数据包

- 数据链路层故障：

   - MAC地址冲突

   - ADSL欠费

   - 网速没办法协商一致

   - 计算机连接到错误的VLAN

- 网络层故障

   - 规划地址

   - 选择路径

   - 配置了错误的ip地址，子网掩码，错误的网关

   - 路由器上没有配置到达目标地址的网络

- 应用层故障

   - 应用程序配置错误

### 1.3 OSI和网络安全

- 物理层安全

- 数据链路层安全：

   - ADSL 帐号密码

   - 数据链路层安全

   - VLAN

   - 交换机端口绑定MAC地址

- 网络层安全

   - 在路由器上使用ACL控制数据包流量

- 应用层安全

   - 开发的应用程序没有漏洞

### 1.4 TCP/IP 协议和OSI参考模型

由上至下共分4层：

- 应用层：

   - HTTP，FTP，DNS

- 传输层：

   - TCP，UDP

- 网络层：

   - ICMP，IGMP

   - IP

   - ARP

- 数据链路层；物理层：

   - Ethernet，ATM，Frame Relay 

**再看数据传输过程：**

应用层，表示层，会话层：

- 上层数据

传输层：

- TCP头+上层数据 *（数据段或消息）*

网络层：

- IP头 + （TCP + 上层数据）*（数据包）*

数据链路层：

- MAC头 + （IP + TCP + 上层数据） + FCS*（数据帧）*

物理层：

- 01110101011011111100000000*（Bit）*

**数据封装**

- 目标MAC地址源MAC地址 + 目标IP地址源IP地址 + 源端口目标端口 + 数据 + FCS

  - 称为数据帧

- 目标IP地址源IP地址 + 源端口目标端口 + 数据

  - 称为数据包

- 源端口目标端口 + 数据

  - 称为数据段或消息

- 计算机在接收到数据帧之后，需要去掉为了传输而添加的附加信息，这称为解封装，是上述封装操作的逆向过程

### 1.5 计算机网络的性能

性能指标：速率；带宽；吞吐量；时延；时延带宽积；往返时间；利用率

- 速率：连接在计算机网络上的**主机**在数字信道上传送**数据位数**的速率，也称为**data rate**或**bit rate**，单位是`b/s,kb/s,Mb/s,Gb/s`

- 带宽：网络所支持的最高速率

- 吞吐量：单位时间内通过某个网络的数据量

- 时延：

  - 发送时延：数据块长度（bit）/信道带宽（bit/s）

  - 传播时延： 铜线比光纤快

  - 处理时延

  - 排队时延

- 时延带宽积

  - 时延带宽积 = 传播时延 x 带宽

  - 数据链路上有多少数据

- 往返时间RTT（Round-Trip Time）

  - 从发送方发送数据开始，到接受方收到确认

  - 可以用ping测试RTT

- 利用率：

  - 信道利用率：有数据通过的时间/（有 + 无 数据通过的时间）

  - 网络利用率：信道利用率加权平均值
